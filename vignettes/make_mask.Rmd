---
title: "Generate a mask file and add it to the data cube"
author: "Wanda De Keersmaecker"
date: "7/7/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, eval =F)
```

# General 
The goal of this document is to generate and add a mask file to an existing data cube with optical data. This cube should be generated with the FORCE software and follow the specifications as defined in make_Landsat_cube.Rmd. If no data cube is available, please generate one first. 

The mask 

## Inputs
```{r}
forcefolder <- '/home/wanda/Documents/data/force'#Sys.getenv("HOME")#'/home/wanda/Documents/data/force'
ext <- c(-43.38238361637443,-43.27938679020256,-4.555765244985907,-4.451717415449725)#extent, vector with xmin, xmax, ymin, ymax in degrees
starttime <- c(2000,11,01)#start date: year, month, day
endtime <- c(2005,4,28)#end date: year, month, day

```

## Generate the directory structure
```{r}
tmpfolder <- file.path(forcefolder, 'temp')
queuefolder <- file.path(forcefolder, 'level1')
queuefile <- 'queue.txt'
lcfolder <- file.path(forcefolder, 'misc','lc')
tcfolder <- file.path(forcefolder, 'misc','tc')
firefolder <- file.path(forcefolder, 'misc','fire')
paramfolder <- file.path(forcefolder, 'param') 
paramfile <- 'l2param.prm'

if(!dir.exists(lcfolder)){dir.create(lcfolder)}
if(!dir.exists(tcfolder)){dir.create(tcfolder)}
if(!dir.exists(firefolder)){dir.create(firefolder)}
```

## Prepare land cover data
```{r}
# Download MapBiomas land cover data
dllLandcover(lcfolder)
# Crop the land cover data to exent and time period of interest 
prepLandcover(lcfolder, tmpfolder, ext, fname = 'landcover.tif', starttime[1], endtime[1])
```

## Prepare tree cover data
```{r}
# Download tree cover data
dllTreecover(ofolder, ext)
# Crop the tree cover data to exent of interest and mask nodata values
prepTreecover(ifolder, datafolder, ext, fname = 'treecover.tif', hanfiles, hanmaskfiles)
```

## Prepare fire data
```{r}
# Download fire data
dllFire(ofolder)
# Crop the fire data to exent and time period of interest 
prepFire(ifolder, datafolder, ext, fjdname = 'fireJD.tif', fclname = 'fireCL.tif', startyr, endyr, fireclfiles, firejdfiles)
```

## Generate mask
```{r}

```




















